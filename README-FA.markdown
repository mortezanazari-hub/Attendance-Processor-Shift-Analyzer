# ๐ ูุณุชูุฏุงุช ูพุฑูฺู: ุงุจุฒุงุฑ ูพุฑุฏุงุฒุด ู ฺฏุฒุงุฑุด ุญุถูุฑ ู ุบุงุจ

ุงุจุฒุงุฑ ูุฏุฑุชููุฏ ุจุฑุง ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุฎุงู ุญุถูุฑ ู ุบุงุจ ุฏุณุชฺฏุงูโูุง Time Clockุ ุชุดุฎุต ุฎูุฏฺฉุงุฑ ุดูุชโูุง ฺฉุงุฑุ ูุญุงุณุจู ุฌุฒุฆุงุช ุญุถูุฑ (ูุงููุฏ ุชุฃุฎุฑุ ุฎุฑูุฌ ุฒูุฏููฺฏุงู ู ุงุถุงููโฺฉุงุฑ) ู ุชููุฏ ฺฏุฒุงุฑุดโูุง ุฌุงูุน ุฏุฑ ูุงูุจ Excel ู CSV (ุณุงุฒฺฏุงุฑ ุจุง Odoo).

---

## ๐ฏ ูฺฺฏโูุง ุงุตู

- **ูุงฺููุงุฑ ู ูุงุจู ุชูุธู**: ูพุฑูฺู ุจู ุณู ูุงฺูู (`settings.py`ุ `shift_logic.py`ุ `main_processor.py`) ุชูุณู ุดุฏู ุจุฑุง ูุฏุฑุช ู ุชูุณุนู ุขุณุงู.
- **ุชุดุฎุต ุดูุช ุฎูุฏฺฉุงุฑ**: ุชุดุฎุต ุจูุชุฑู ุดูุช (ุตุจุญุ ุนุตุฑุ ุดุจ) ุจุฑ ุงุณุงุณ ุฒูุงู ูุฑูุฏ ู ุฎุฑูุฌุ ููุงุณุจ ุจุฑุง ฺฉุงุฑููุฏุงู ุจุฏูู ุดูุช ุซุงุจุช.
- **ูพุดุชุจุงู ุงุฒ ุชุงุฑุฎ ุดูุณ ู ููุงุฏ**: ูพุฑุฏุงุฒุด ูุงูโูุง ูุฑูุฏ ุจุง ูุฑูุช **ุฌูุงู** ุง **ููุงุฏ**.
- **ฺฏุฒุงุฑุดโุฏู ุฏูู**: ูุญุงุณุจู **ูุฏุช ุฒูุงู ุญุถูุฑ**ุ **ุงุถุงููโฺฉุงุฑ**ุ **ุชุฃุฎุฑ**ุ **ุชุนุฌู ุฏุฑ ูุฑูุฏ**ุ **ุฎุฑูุฌ ุฒูุฏููฺฏุงู** ู **ูุฑุฎุต ุณุงุนุช** ุจุง ุฌุฒุฆุงุช ุฒูุงู.
- **ุฎุฑูุฌ Excel ฺูุฏฺฏุงูู**: ุชููุฏ ูุงู Excel ุจุง **ฺฏุฒุงุฑุด ฺฉุงูู** (ุฌุฏููโุจูุฏ ู ููุชุฑฺฏุฐุงุฑโุดุฏู) ู **ุฒุฑุจุฑฺฏูโูุง** ุจุฑุง ูุฑ ฺฉุงุฑููุฏ.
- **ุฎุฑูุฌ ุขูุงุฏู Odoo**: ุชููุฏ ูุงู CSV ุจุง ุณุชููโูุง ุงุณุชุงูุฏุงุฑุฏ (`employee_id`ุ `check_in`ุ `check_out`ุ `overtime`) ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุฏุฑ ุณุณุชูโูุง ERP ูุงููุฏ Odoo.

---

## ๐๏ธ ูพุดโูุงุฒูุง

ุจุฑุง ุงุฌุฑุง ุจุฑูุงููุ **Python** ู ูพฺฉุฌโูุง ุฒุฑ ููุฑุฏ ูุงุฒ ุงุณุช:

```bash
pip install pandas jdatetime xlsxwriter openpyxl tk
```

---

## ๐ ุณุงุฎุชุงุฑ ูพุฑูฺู

ูพูุดู ูพุฑูฺู ุจุงุฏ ุดุงูู ูุงูโูุง ุฒุฑ ุจุงุดุฏ:

```
/attendance_processor/
โโโ main_processor.py       # ููุทู ุงุตู ู ุฌุฑุงู ุงุฌุฑุง ุจุฑูุงูู
โโโ settings.py             # ุชุนุฑู ุซุงุจุชโูุงุ ููพโูุง ู ูุฏูโูุง ุดูุช
โโโ shift_logic.py          # ุชูุงุจุน ฺฉูฺฉุ ูุญุงุณุจุงุช ุฒูุงู ู ููุทู ุชุดุฎุต ุดูุช
โโโ employee_map.xlsx       # ูุงู ูฺฏุงุดุช ฺฉุงุฑููุฏุงู (ุงูุฒุงู)
```

---

## โ๏ธ ุชูุธู ูุงู `employee_map.xlsx`

ุงู ูุงู ุจุงุฏ ุดุงูู ุณู ุณุชูู ุฒุฑ ุจุงุดุฏ:

| ุณุชูู            | ุชูุถุญุงุช                                      |
|------------------|---------------------------------------------|
| `device_id`      | ุดูุงุณู ฺฉุงุฑููุฏ/ุฏุณุชฺฏุงู ุฏุฑ ูุงู ุฎุงู (ูุซู `EnNo` ุง `Name`). |
| `odoo_id`        | ฺฉุฏ ฺฉุงุฑููุฏ ุจุฑุง ุฎุฑูุฌ ููุง ู ูุงู CSV.     |
| `shift_model`    | ูุฏู ุดูุช (ูุซู `single_friday_off`ุ `triple_shift` ุง `auto_detect`). |

### ูุฏูโูุง ุดูุช ูพุดุชุจุงูโุดุฏู

| ูุฏู ุดูุช            | ููุน          | ุชูุถุญุงุช                                      |
|---------------------|--------------|---------------------------------------------|
| `single_friday_off` | ุซุงุจุช         | ุดูุช ุซุงุจุช ุจุง ุชุนุทู ุฌูุนู (ูููโุดูุช ูพูุฌโุดูุจู). |
| `single_saturday_off` | ุซุงุจุช       | ุดูุช ุซุงุจุช ุจุง ุชุนุทู ุดูุจู (ูููโุดูุช ูพูุฌโุดูุจู). |
| `double_shift`      | ฺุฑุฎุด       | ุดูุช ุฏูฺฏุงูู (ุตุจุญ ู ุนุตุฑ) ุจุง ฺุฑุฎุด ููุชฺฏ.      |
| `triple_shift`      | ฺุฑุฎุด       | ุดูุช ุณูโฺฏุงูู (ุตุจุญุ ุนุตุฑุ ุดุจ) ุจุง ฺุฑุฎุด ููุชฺฏ.  |
| `long_shift`        | ุจููุฏ (12ุณุงุนุชู) | ุดูุช ุซุงุจุช 12 ุณุงุนุชู.                      |
| **`auto_detect`**   | ุฎูุฏฺฉุงุฑ       | ุชุดุฎุต ุฎูุฏฺฉุงุฑ ุจูุชุฑู ุดูุช (ุตุจุญ/ุนุตุฑ/ุดุจ).      |

---

## ๐ ุฑุงูููุง ุงุฌุฑุง

1. **ุขูุงุฏูโุณุงุฒ**: ูุงูโูุง Python ู `employee_map.xlsx` ุฑุง ุฏุฑ ฺฉ ูพูุดู ูุฑุงุฑ ุฏูุฏ.
2. **ุงุฌุฑุง**: ูุงู ุงุตู ุฑุง ุงุฒ ุชุฑููุงู ุงุฌุฑุง ฺฉูุฏ:

   ```bash
   python main_processor.py
   ```

3. **ุฏูุจุงู ฺฉุฑุฏู ุฏุณุชูุฑุงูุนููโูุง**:
   - **ููุน ุชุงุฑุฎ ูุฑูุฏ**: ุงูุชุฎุงุจ ฺฉูุฏ ฺฉู ูุงู ุฎุงู ุงุฒ ุชุงุฑุฎ ุดูุณ ุง ููุงุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ.
   - **ุงูุชุฎุงุจ ูุงู ุฎุงู**: ูุงู Excel ุญุถูุฑ ู ุบุงุจ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
   - **ุงูุชุฎุงุจ ูุณุฑ ุฎุฑูุฌ**: ูุณุฑ ู ูุงู ูุงู ุฎุฑูุฌ Excel ุฑุง ูุดุฎุต ฺฉูุฏ.
   - **ุงูุชุฎุงุจ `employee_map`**: ุงฺฏุฑ ูุงู `employee_map.xlsx` ูพุฏุง ูุดูุฏุ ูพูุฌุฑูโุง ุจุฑุง ุงูุชุฎุงุจ ุฏุณุช ุจุงุฒ ูโุดูุฏ.

4. **ุฎุฑูุฌ**: ุฏู ูุงู (Excel ู CSV) ุฏุฑ ูุณุฑ ูุดุฎุตโุดุฏู ุชููุฏ ูโุดูุฏ.

---

## ๐ง ููุทู ู ูุญุงุณุจุงุช ูู

### ฑ. ุฑูุฒ ฺฉุงุฑ ููุทู (`logical_date`)
ุจุฑุง ุดูุชโูุง ุดุจุงููุ ฺฉ **CUTOFF_HOUR** (ูพุดโูุฑุถ **05:00 ุตุจุญ**) ุชุนุฑู ุดุฏู ุงุณุช. ุฑฺฉูุฑุฏูุง ูุจู ุงุฒ ุงู ุณุงุนุช ุจู "ุฑูุฒ ฺฉุงุฑ" ูุจู ุงุฎุชุตุงุต ูโุงุจูุฏ.

### ฒ. ูุญุงุณุจู ูุฑุฎุต ุณุงุนุช
- **ููุทู**: ุจุฑุฑุณ ูุงุตูู ุจู `check_out` ู `check_in` ูุชูุงู ุฏุฑ ฺฉ ุฑูุฒ.
- **ุขุณุชุงูู**: ูุงุตููโูุง ุจุด ุงุฒ **MIN_LEAVE_GAP** (ูพุดโูุฑุถ **0.5 ุณุงุนุช/30 ุฏููู**) ุจูโุนููุงู **ูุฑุฎุต ุณุงุนุช** ุซุจุช ูโุดููุฏ.

### ณ. ูุญุงุณุจุงุช ุฌุฒุฆุงุช ุญุถูุฑ
| ุขุชู              | ูุญูู ูุญุงุณุจู                              |
|-------------------|------------------------------------------|
| **ุชุฃุฎุฑ**        | `MAX(0, ุฒูุงู ูุฑูุฏ - ุฒูุงู ุดุฑูุน ุดูุช)`     |
| **ุฎุฑูุฌ ุฒูุฏููฺฏุงู** | `MAX(0, ุฒูุงู ูพุงุงู ุดูุช - ุฒูุงู ุฎุฑูุฌ)`   |
| **ุงุถุงููโฺฉุงุฑ**   | `MAX(0, ฺฉู ุณุงุนุงุช ุญุถูุฑ - ุณุงุนุงุช ุดูุช ุงุณุชุงูุฏุงุฑุฏ)` |

> **ูฺฉุชู**: ุฏุฑ ุฑูุฒูุง ุจุฏูู ุดูุช (ูุซู ุชุนุทูุงุช ููุชฺฏ)ุ ฺฉู ุณุงุนุงุช ุญุถูุฑ ุจูโุนููุงู **ุงุถุงููโฺฉุงุฑ** ูุญุงุณุจู ูโุดูุฏ.

---

## ๐ ูพุดุชุจุงู ุงุฒ ุฒุจุงู
ุงู ูุณุชูุฏุงุช ุจู ูุฑ ุฏู ุฒุจุงู **ูุงุฑุณ** ู **ุงูฺฏูุณ** ุงุฑุงุฆู ุดุฏู ุงุณุช ุชุง ุฏุณุชุฑุณ ฺฏุณุชุฑุฏูโุชุฑ ูุฑุงูู ุดูุฏ. ุจุฑุง ุฌุฒุฆุงุช ุงูฺฏูุณุ ุจู ูุงู ูุฑุจูุทู ูุฑุงุฌุนู ฺฉูุฏ.